{
  "version": 4,
  "terraform_version": "0.12.20",
  "serial": 99,
  "lineage": "9ca5a033-763f-3638-740e-e87e9955dc42",
  "outputs": {},
  "resources": [
    {
      "mode": "managed",
      "type": "aws_cloudwatch_log_group",
      "name": "spotfleet_request_control",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:logs:us-east-1:728160576949:log-group:/aws/lambda/spotfleet-request-control:*",
            "id": "/aws/lambda/spotfleet-request-control",
            "kms_key_id": "",
            "name": "/aws/lambda/spotfleet-request-control",
            "name_prefix": null,
            "retention_in_days": 30,
            "tags": {}
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_ecs_cluster",
      "name": "automata",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:ecs:us-east-1:728160576949:cluster/automata",
            "capacity_providers": [
              "FARGATE_SPOT"
            ],
            "default_capacity_provider_strategy": [],
            "id": "arn:aws:ecs:us-east-1:728160576949:cluster/automata",
            "name": "automata",
            "setting": [
              {
                "name": "containerInsights",
                "value": "disabled"
              }
            ],
            "tags": {}
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_instance_profile",
      "name": "spotfleet_automata_node",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::728160576949:instance-profile/automata-spotfleet-profile",
            "create_date": "2020-03-14T16:07:03Z",
            "id": "automata-spotfleet-profile",
            "name": "automata-spotfleet-profile",
            "name_prefix": null,
            "path": "/",
            "role": "ec2-execution-role",
            "roles": [
              "ec2-execution-role"
            ],
            "unique_id": "AIPA2TCOAUW23PATUR6U6"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.ec2_execution_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "lambda_logging",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::728160576949:policy/lambda-logging",
            "description": "IAM policy for logging from a lambda",
            "id": "arn:aws:iam::728160576949:policy/lambda-logging",
            "name": "lambda-logging",
            "name_prefix": null,
            "path": "/",
            "policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:*\",\n      \"Effect\": \"Allow\"\n    }\n  ]\n}\n"
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "ec2_execution_role",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::728160576949:role/ec2-execution-role",
            "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Sid\":\"\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ec2.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}",
            "create_date": "2020-03-14T16:07:02Z",
            "description": "",
            "force_detach_policies": false,
            "id": "ec2-execution-role",
            "max_session_duration": 3600,
            "name": "ec2-execution-role",
            "name_prefix": null,
            "path": "/",
            "permissions_boundary": null,
            "tags": {},
            "unique_id": "AROA2TCOAUW2QMVGEKKX3"
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "lambda_spotfleet_request_control_role",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::728160576949:role/lambda-spotfleet-request-control-role",
            "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Sid\":\"\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}",
            "create_date": "2020-03-15T02:13:52Z",
            "description": "",
            "force_detach_policies": false,
            "id": "lambda-spotfleet-request-control-role",
            "max_session_duration": 3600,
            "name": "lambda-spotfleet-request-control-role",
            "name_prefix": null,
            "path": "/",
            "permissions_boundary": null,
            "tags": {},
            "unique_id": "AROA2TCOAUW24XBWFPSIE"
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "automata_attach_ecs_ec2",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "ec2-execution-role-20200314160714278900000002",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceforEC2Role",
            "role": "ec2-execution-role"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.ec2_execution_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "lambda_ec2_readonly_policy",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "lambda-spotfleet-request-control-role-20200317025058380300000001",
            "policy_arn": "arn:aws:iam::aws:policy/AmazonEC2ReadOnlyAccess",
            "role": "lambda-spotfleet-request-control-role"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.lambda_spotfleet_request_control_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "lambda_spotfleet_request_control_logs",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "lambda-spotfleet-request-control-role-20200315021405367200000001",
            "policy_arn": "arn:aws:iam::728160576949:policy/lambda-logging",
            "role": "lambda-spotfleet-request-control-role"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_policy.lambda_logging",
            "aws_iam_role.lambda_spotfleet_request_control_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "lambda_spotfleet_request_execution_policy",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "lambda-spotfleet-request-control-role-20200315021405367200000002",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AmazonEC2SpotFleetAutoscaleRole",
            "role": "lambda-spotfleet-request-control-role"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.lambda_spotfleet_request_control_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "spotfleet_request_control",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-east-1:728160576949:function:spotfleet-request-control",
            "dead_letter_config": [],
            "description": "Manages spotfleet request lifecycle",
            "environment": [],
            "filename": "../build/_output/artifacts/spotfleetrequestcontrol.zip",
            "function_name": "spotfleet-request-control",
            "handler": "main",
            "id": "spotfleet-request-control",
            "invoke_arn": "arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:728160576949:function:spotfleet-request-control/invocations",
            "kms_key_arn": "",
            "last_modified": "2020-03-18T03:15:04.718+0000",
            "layers": [],
            "memory_size": 128,
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-east-1:728160576949:function:spotfleet-request-control:$LATEST",
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::728160576949:role/lambda-spotfleet-request-control-role",
            "runtime": "go1.x",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "source_code_hash": "6+upWa3iKvR39UiuWE7LmFE0pm7Z6C+oXnmNh1qbm9c=",
            "source_code_size": 8944229,
            "tags": {},
            "timeout": 600,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "aws_cloudwatch_log_group.spotfleet_request_control",
            "aws_iam_role.lambda_spotfleet_request_control_role",
            "aws_iam_role_policy_attachment.lambda_spotfleet_request_control_logs"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_spot_fleet_request",
      "name": "automata",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "allocation_strategy": "lowestPrice",
            "client_token": "terraform-20200314160714783500000003",
            "excess_capacity_termination_policy": "Default",
            "fleet_type": "maintain",
            "iam_fleet_role": "arn:aws:iam::728160576949:role/aws-service-role/spotfleet.amazonaws.com/AWSServiceRoleForEC2SpotFleet",
            "id": "sfr-f0ac66b3-6c02-4c5f-bb10-cc2a92628e23",
            "instance_interruption_behaviour": "terminate",
            "instance_pools_to_use_count": 1,
            "launch_specification": [
              {
                "ami": "ami-056807e883f197989",
                "associate_public_ip_address": false,
                "availability_zone": "",
                "ebs_block_device": [],
                "ebs_optimized": false,
                "ephemeral_block_device": [],
                "iam_instance_profile": "",
                "iam_instance_profile_arn": "arn:aws:iam::728160576949:instance-profile/automata-spotfleet-profile",
                "instance_type": "m4.large",
                "key_name": "",
                "monitoring": false,
                "placement_group": "",
                "placement_tenancy": "",
                "root_block_device": [],
                "spot_price": "",
                "subnet_id": "subnet-988acfd2",
                "tags": {},
                "user_data": "a754eb55844f073c0c621c235a77a1ed876f3edc",
                "vpc_security_group_ids": [],
                "weighted_capacity": ""
              }
            ],
            "load_balancers": [],
            "replace_unhealthy_instances": false,
            "spot_price": "0.0361",
            "spot_request_state": "active",
            "target_capacity": 1,
            "target_group_arns": [],
            "terminate_instances_with_expiration": true,
            "timeouts": null,
            "valid_from": null,
            "valid_until": "2033-01-01T01:00:00Z",
            "wait_for_fulfillment": false
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "aws_iam_instance_profile.spotfleet_automata_node",
            "aws_iam_role.ec2_execution_role"
          ]
        }
      ]
    }
  ]
}
